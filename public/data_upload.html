<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Data Upload</title>
<style>
:root {
  --primary-color: #673ab7;
  --secondary-color: #e91e63;
  --bg-color: #f4f4f4;
  --text-color: #333;
  --shadow-color: rgba(0,0,0,0.2);
  --border-radius: 8px;
  --spacing-unit: 1rem;
}

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background-color: var(--bg-color);
  color: var(--text-color);
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
  margin: 0;
  line-height: 1.6;
}

.container {
  max-width: 600px;
  width: 90%;
  padding: var(--spacing-unit);
  border-radius: var(--border-radius);
  background: linear-gradient(to bottom right, #f0f0f0, #ffffff);
  box-shadow: 0 4px 8px var(--shadow-color);
  margin: 2rem auto;
}

h1 {
  font-size: 2rem;
  color: var(--primary-color);
  margin-bottom: var(--spacing-unit);
}

.upload-area {
  border: 2px dashed var(--secondary-color);
  padding: 4rem;
  border-radius: var(--border-radius);
  text-align: center;
  background-color: rgba(255,255,255,0.8);
  transition: background-color 0.3s ease;
  cursor: pointer;
}

.upload-area:hover {
  background-color: rgba(255,255,255,0.9);
}

.upload-area.dragover {
  background-color: rgba(255,255,255,0.7);
}

input[type="file"] {
  display: none;
}

.progress-bar {
  width: 0%;
  height: 20px;
  background-color: var(--primary-color);
  border-radius: var(--border-radius);
  margin-top: var(--spacing-unit);
  transition: width 0.3s ease;
}

.message {
  margin-top: var(--spacing-unit);
  padding: var(--spacing-unit);
  border-radius: var(--border-radius);
}

.message.success {
  background-color: #d4edda;
  color: #155724;
  border: 1px solid #c3e6cb;
}

.message.error {
  background-color: #f8d7da;
  color: #721c24;
  border: 1px solid #f5c6cb;
}

@media (max-width: 400px) {
  .container {
    padding: 1rem;
  }
}
</style>
</head>
<body>
<div class="container">
  <h1>Data Upload</h1>
  <div class="upload-area" aria-describedby="upload-instructions">
    <p id="upload-instructions">Drag & Drop CSV or Excel file here or <span role="button" tabindex="0" onclick="document.getElementById('fileInput').click()">Browse</span></p>
    <input type="file" id="fileInput" accept=".csv,.xlsx,.xls" onchange="uploadFile(this)">
  </div>
  <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="Upload Progress"></div>
  <div class="message" aria-live="assertive" role="alert"></div>
</div>
<script>
const uploadArea = document.querySelector('.upload-area');
const progressBar = document.querySelector('.progress-bar');
const message = document.querySelector('.message');
const fileInput = document.getElementById('fileInput');

uploadArea.addEventListener('dragover', (e) => {
  e.preventDefault();
  uploadArea.classList.add('dragover');
});

uploadArea.addEventListener('dragleave', () => {
  uploadArea.classList.remove('dragover');
});

uploadArea.addEventListener('drop', (e) => {
  e.preventDefault();
  uploadArea.classList.remove('dragover');
  uploadFile(e.dataTransfer.files[0]);
});

function uploadFile(file) {
  if (!file) return;

  const reader = new FileReader();

  reader.onload = (e) => {
    const data = e.target.result;
    // Simulate upload process
    let progress = 0;
    const interval = setInterval(() => {
      progress += 10;
      progressBar.style.width = progress + '%';
      progressBar.setAttribute('aria-valuenow', progress);
      if (progress >= 100) {
        clearInterval(interval);
        //Simulate success
        message.textContent = "Upload successful!";
        message.classList.add('success');
        message.classList.remove('error');

        // Reset for next upload
        progressBar.style.width = '0%';
        progressBar.setAttribute('aria-valuenow', '0');
      }
    }, 100);
  }

  reader.onerror = (e) => {
    message.textContent = "Upload failed: " + e.target.error.name;
    message.classList.add('error');
    message.classList.remove('success');
    progressBar.style.width = '0%';
    progressBar.setAttribute('aria-valuenow', '0');
  };

  reader.readAsText(file);
}
</script>
</body>
</html>